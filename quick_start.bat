@echo off
chcp 65001 >nul
title YouTube Analyzer - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
color 0A

echo.
echo ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
echo ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù
echo    ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  
echo    ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  
echo    ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù   ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
echo    ‚ïö‚ïê‚ïù    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù    ‚ïö‚ïê‚ïù    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
echo.
echo              –ê–ù–ê–õ–ò–ó–ê–¢–û–† YOUTUBE –ö–û–ù–ö–£–†–ï–ù–¢–û–í
echo        –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤–∏–¥–µ–æ –∏ –∫–∞–Ω–∞–ª–æ–≤ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
echo.
echo =============================================================================

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
if not exist "C:\youtube-analyzer" (
    echo ‚ùå –ü–∞–ø–∫–∞ C:\youtube-analyzer –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!
    echo.
    echo üìã –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
    echo.
    echo 1. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É C:\youtube-analyzer
    echo 2. –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª setup_windows.bat –≤ —ç—Ç—É –ø–∞–ø–∫—É
    echo 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ setup_windows.bat –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    echo 4. –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ –≤ –ø–∞–ø–∫—É
    echo.
    pause
    exit /b 1
)

cd /d "C:\youtube-analyzer"

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
if not exist "venv\Scripts\python.exe" (
    echo ‚ùå –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!
    echo.
    echo üîß –ó–∞–ø—É—Å—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É:
    echo    setup_windows.bat
    echo.
    pause
    exit /b 1
)

if not exist "main.py" (
    echo ‚ùå –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!
    echo.
    echo üìÅ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ C:\youtube-analyzer\ –Ω–∞—Ö–æ–¥—è—Ç—Å—è:
    echo    - main.py
    echo    - config.py  
    echo    - src\*.py —Ñ–∞–π–ª—ã
    echo    - requirements.txt
    echo.
    pause
    exit /b 1
)

echo ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞...
call venv\Scripts\activate

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ .env —Ñ–∞–π–ª–∞
if not exist ".env" (
    echo ‚öôÔ∏è  –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...
    (
        echo # YouTube Analyzer Configuration
        echo YOUTUBE_API_KEY=
        echo YOUTUBE_COOKIES_FILE=C:\youtube-analyzer\cookies.txt
        echo MAX_TOTAL_VIDEOS=50
        echo MAX_CHANNELS_TO_ANALYZE=20
        echo MAX_WORKERS=4
        echo REQUEST_DELAY=2.0
        echo LOG_LEVEL=INFO
        echo LOG_FILE=C:\youtube-analyzer\logs\youtube_analysis.log
        echo ENABLE_TRANSCRIPT_EXTRACTION=true
        echo ENABLE_CONTENT_ANALYSIS=true
        echo EXCEL_OUTPUT_ENABLED=true
    ) > .env
    echo ‚úÖ –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
)

echo.
echo üéØ –î–û–ë–†–û –ü–û–ñ–ê–õ–û–í–ê–¢–¨ –í YOUTUBE ANALYZER!
echo.
echo üìä –≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–æ–º–æ–∂–µ—Ç –≤–∞–º:
echo    ‚Ä¢ –ù–∞–π—Ç–∏ –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–∏–¥–µ–æ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
echo    ‚Ä¢ –ò–∑—É—á–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —É—Å–ø–µ—à–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤  
echo    ‚Ä¢ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–µ–º—ã –∏ —Ñ–æ—Ä–º–∞—Ç—ã
echo    ‚Ä¢ –ü–æ–ª—É—á–∏—Ç—å insights –¥–ª—è –≤–∞—à–µ–π –∫–æ–Ω—Ç–µ–Ω—Ç-—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
echo.

:main_menu
echo =============================================================================
echo üéÆ –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ
echo =============================================================================
echo.
echo 1. üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
echo 2. ‚öôÔ∏è  –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é  
echo 3. üìä –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≥–æ—Ç–æ–≤—ã–µ –æ—Ç—á–µ—Ç—ã
echo 4. üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
echo 5. üìö –ü–æ–º–æ—â—å –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
echo 6. üö™ –í—ã—Ö–æ–¥
echo.

set /p choice="–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é (1-6): "

if "%choice%"=="1" goto analysis
if "%choice%"=="2" goto config
if "%choice%"=="3" goto reports  
if "%choice%"=="4" goto diagnostics
if "%choice%"=="5" goto help
if "%choice%"=="6" goto exit
echo ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.
goto main_menu

:analysis
cls
echo =============================================================================
echo üöÄ –ó–ê–ü–£–°–ö –ê–ù–ê–õ–ò–ó–ê –ö–û–ù–ö–£–†–ï–ù–¢–û–í
echo =============================================================================
echo.

set /p offer="üìù –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ñ—Ñ–µ—Ä (–æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞/—É—Å–ª—É–≥–∏): "

if "%offer%"=="" (
    echo ‚ùå –û—Ñ—Ñ–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º!
    pause
    goto main_menu
)

echo.
echo üìä –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∞–Ω–∞–ª–∏–∑–∞:
echo.
echo 1. üèÉ –ë—ã—Å—Ç—Ä—ã–π (25 –≤–∏–¥–µ–æ, 15 –∫–∞–Ω–∞–ª–æ–≤, –±–µ–∑ —Å—É–±—Ç–∏—Ç—Ä–æ–≤) - ~5 –º–∏–Ω—É—Ç
echo 2. üìà –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π (50 –≤–∏–¥–µ–æ, 20 –∫–∞–Ω–∞–ª–æ–≤) - ~15 –º–∏–Ω—É—Ç  
echo 3. üî¨ –î–µ—Ç–∞–ª—å–Ω—ã–π (100 –≤–∏–¥–µ–æ, 30 –∫–∞–Ω–∞–ª–æ–≤) - ~30 –º–∏–Ω—É—Ç
echo 4. üéØ –¢–æ–ª—å–∫–æ –∫–∞–Ω–∞–ª—ã (–±–µ–∑ –∞–Ω–∞–ª–∏–∑–∞ –≤–∏–¥–µ–æ) - ~10 –º–∏–Ω—É—Ç
echo 5. ‚öôÔ∏è  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
echo.

set /p analysis_type="–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø (1-5): "

if "%analysis_type%"=="1" (
    set params=--max-videos 25 --max-channels 15 --no-transcripts --parallel 6
    set duration=5 –º–∏–Ω—É—Ç
) else if "%analysis_type%"=="2" (
    set params=--max-videos 50 --max-channels 20 --parallel 4
    set duration=15 –º–∏–Ω—É—Ç
) else if "%analysis_type%"=="3" (
    set params=--max-videos 100 --max-channels 30 --parallel 6
    set duration=30 –º–∏–Ω—É—Ç
) else if "%analysis_type%"=="4" (
    set params=--channels-only --max-channels 25 --no-transcripts
    set duration=10 –º–∏–Ω—É—Ç
) else if "%analysis_type%"=="5" (
    echo.
    set /p max_videos="–ú–∞–∫—Å–∏–º—É–º –≤–∏–¥–µ–æ: "
    set /p max_channels="–ú–∞–∫—Å–∏–º—É–º –∫–∞–Ω–∞–ª–æ–≤: "
    set /p parallel="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤: "
    
    set params=--max-videos %max_videos% --max-channels %max_channels% --parallel %parallel%
    set duration=–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫
) else (
    set params=--max-videos 50 --max-channels 20
    set duration=15 –º–∏–Ω—É—Ç
)

echo.
set /p keywords="üìé –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (Enter = –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å): "
if not "%keywords%"=="" set params=%params% --keywords "%keywords%"

echo.
echo üéØ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–Ω–∞–ª–∏–∑–∞:
echo    ‚Ä¢ –û—Ñ—Ñ–µ—Ä: %offer%
echo    ‚Ä¢ –ù–∞—Å—Ç—Ä–æ–π–∫–∏: %params%  
echo    ‚Ä¢ –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è: %duration%
echo.

set /p confirm="‚ñ∂Ô∏è  –ù–∞—á–∞—Ç—å –∞–Ω–∞–ª–∏–∑? (y/n): "
if /i not "%confirm%"=="y" goto main_menu

echo.
echo üöÄ –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞... –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç.
echo üí° –ù–µ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ —ç—Ç–æ –æ–∫–Ω–æ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è!
echo.

python main.py --offer "%offer%" %params%

set result=%errorlevel%

echo.
if %result% equ 0 (
    echo üéâ –ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù –£–°–ü–ï–®–ù–û!
    echo.
    echo üìÅ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤: C:\youtube-analyzer\reports\
    
    set /p open_reports="üìä –û—Ç–∫—Ä—ã—Ç—å –ø–∞–ø–∫—É —Å –æ—Ç—á–µ—Ç–∞–º–∏? (y/n): "
    if /i "%open_reports%"=="y" explorer reports
) else (
    echo ‚ùå –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–∞–º–∏
    echo üìã –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥: logs\youtube_analysis.log
)

pause
goto main_menu

:config
cls
echo =============================================================================
echo ‚öôÔ∏è  –ù–ê–°–¢–†–û–ô–ö–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò
echo =============================================================================
echo.

echo –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env):
echo.
type .env
echo.
echo.

echo üîß –û–ø—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
echo.
echo 1. üîë –î–æ–±–∞–≤–∏—Ç—å YouTube API –∫–ª—é—á
echo 2. üç™ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å cookies —Ñ–∞–π–ª
echo 3. üåê –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–∫—Å–∏
echo 4. ‚ö° –ò–∑–º–µ–Ω–∏—Ç—å –ª–∏–º–∏—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
echo 5. üìù –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env –≤ –±–ª–æ–∫–Ω–æ—Ç–µ
echo 6. üîÑ –°–±—Ä–æ—Å–∏—Ç—å –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
echo 7. ‚¨ÖÔ∏è  –ù–∞–∑–∞–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
echo.

set /p config_choice="–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é (1-7): "

if "%config_choice%"=="1" (
    echo.
    echo üîë YouTube API Key –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:
    echo.
    echo üìã –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è API –∫–ª—é—á–∞:
    echo 1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://console.cloud.google.com/
    echo 2. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏ –≤–∫–ª—é—á–∏—Ç–µ YouTube Data API v3
    echo 3. –°–æ–∑–¥–∞–π—Ç–µ API Key –≤ —Ä–∞–∑–¥–µ–ª–µ Credentials
    echo.
    set /p api_key="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à API –∫–ª—é—á (–∏–ª–∏ Enter –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞): "
    
    if not "%api_key%"=="" (
        powershell -Command "(Get-Content .env) -replace 'YOUTUBE_API_KEY=.*', 'YOUTUBE_API_KEY=%api_key%' | Set-Content .env"
        echo ‚úÖ API –∫–ª—é—á —Å–æ—Ö—Ä–∞–Ω–µ–Ω
    )
) else if "%config_choice%"=="2" (
    echo.
    echo üç™ Cookies –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:
    echo.
    echo üìã –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è cookies:
    echo 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ "Get cookies.txt" –≤ Chrome/Firefox
    echo 2. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ youtube.com
    echo 3. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ cookies –≤ Netscape —Ñ–æ—Ä–º–∞—Ç–µ
    echo 4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª –∫–∞–∫ C:\youtube-analyzer\cookies.txt
    echo.
    
    if exist "cookies.txt" (
        echo ‚úÖ –§–∞–π–ª cookies.txt —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    ) else (
        echo ‚ö†Ô∏è  –§–∞–π–ª cookies.txt –Ω–µ –Ω–∞–π–¥–µ–Ω
        echo –°–æ–∑–¥–∞–π—Ç–µ –µ–≥–æ —Å–æ–≥–ª–∞—Å–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤—ã—à–µ
    )
) else if "%config_choice%"=="3" (
    echo.
    echo üåê –ü—Ä–æ–∫—Å–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:
    echo.
    set /p proxy="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–∫—Å–∏ (—Ñ–æ—Ä–º–∞—Ç: http://proxy:port –∏–ª–∏ Enter –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è): "
    
    powershell -Command "(Get-Content .env) -replace 'HTTP_PROXY=.*', 'HTTP_PROXY=%proxy%' | Set-Content .env"
    echo ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
) else if "%config_choice%"=="4" (
    echo.
    echo ‚ö° –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
    echo.
    set /p max_videos="–ú–∞–∫—Å–∏–º—É–º –≤–∏–¥–µ–æ (—Ç–µ–∫—É—â–∏–π: 50): "
    set /p max_channels="–ú–∞–∫—Å–∏–º—É–º –∫–∞–Ω–∞–ª–æ–≤ (—Ç–µ–∫—É—â–∏–π: 20): "
    set /p max_workers="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ (—Ç–µ–∫—É—â–∏–π: 4): "
    
    if not "%max_videos%"=="" powershell -Command "(Get-Content .env) -replace 'MAX_TOTAL_VIDEOS=.*', 'MAX_TOTAL_VIDEOS=%max_videos%' | Set-Content .env"
    if not "%max_channels%"=="" powershell -Command "(Get-Content .env) -replace 'MAX_CHANNELS_TO_ANALYZE=.*', 'MAX_CHANNELS_TO_ANALYZE=%max_channels%' | Set-Content .env"
    if not "%max_workers%"=="" powershell -Command "(Get-Content .env) -replace 'MAX_WORKERS=.*', 'MAX_WORKERS=%max_workers%' | Set-Content .env"
    
    echo ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
) else if "%config_choice%"=="5" (
    notepad .env
) else if "%config_choice%"=="6" (
    set /p confirm="‚ö†Ô∏è  –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏? (y/n): "
    if /i "%confirm%"=="y" (
        copy .env.example .env >nul 2>&1
        echo ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    )
) else if "%config_choice%"=="7" (
    goto main_menu
)

pause
goto config

:reports
cls
echo =============================================================================
echo üìä –ü–†–û–°–ú–û–¢–† –ì–û–¢–û–í–´–• –û–¢–ß–ï–¢–û–í
echo =============================================================================
echo.

if not exist "reports" (
    echo ‚ùå –ü–∞–ø–∫–∞ —Å –æ—Ç—á–µ—Ç–∞–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
    echo üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤
    pause
    goto main_menu
)

echo üìÅ –î–æ—Å—Ç—É–ø–Ω—ã–µ –æ—Ç—á–µ—Ç—ã:
echo.
dir reports\*.xlsx /b 2>nul
echo.

if %errorlevel% neq 0 (
    echo ‚ùå Excel –æ—Ç—á–µ—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
    echo üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤
) else (
    echo üí° –û–ø—Ü–∏–∏:
    echo.
    echo 1. üìÇ –û—Ç–∫—Ä—ã—Ç—å –ø–∞–ø–∫—É —Å –æ—Ç—á–µ—Ç–∞–º–∏
    echo 2. üìä –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç—á–µ—Ç –ø–æ –≤–∏–¥–µ–æ
    echo 3. üè¢ –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç—á–µ—Ç –ø–æ –∫–∞–Ω–∞–ª–∞–º  
    echo 4. üìà –û—Ç–∫—Ä—ã—Ç—å —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç
    echo 5. ‚¨ÖÔ∏è  –ù–∞–∑–∞–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
    echo.
    
    set /p report_choice="–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é (1-5): "
    
    if "%report_choice%"=="1" (
        explorer reports
    ) else if "%report_choice%"=="2" (
        for /f %%i in ('dir reports\videos_analysis_*.xlsx /b /o-d 2^>nul ^| findstr /n "^" ^| findstr "^1:"') do (
            set latest=%%i
            set latest=!latest:~2!
            start excel "reports\!latest!"
        )
    ) else if "%report_choice%"=="3" (
        for /f %%i in ('dir reports\channels_analysis_*.xlsx /b /o-d 2^>nul ^| findstr /n "^" ^| findstr "^1:"') do (
            set latest=%%i
            set latest=!latest:~2!
            start excel "reports\!latest!"
        )
    ) else if "%report_choice%"=="4" (
        for /f %%i in ('dir reports\summary_report_*.xlsx /b /o-d 2^>nul ^| findstr /n "^" ^| findstr "^1:"') do (
            set latest=%%i
            set latest=!latest:~2!
            start excel "reports\!latest!"
        )
    )
)

pause
goto main_menu

:diagnostics
cls
echo =============================================================================
echo üîß –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –°–ò–°–¢–ï–ú–´
echo =============================================================================
echo.

echo üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã...
echo.

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ Python
python --version >nul 2>&1
if %errorlevel% equ 0 (
    echo ‚úÖ Python: 
    python --version
) else (
    echo ‚ùå Python –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
)

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
if exist "venv\Scripts\python.exe" (
    echo ‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ: —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
) else (
    echo ‚ùå –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ: –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
)

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
echo.
echo üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫...
call venv\Scripts\activate
python -c "
import sys
packages = {
    'requests': 'HTTP –∑–∞–ø—Ä–æ—Å—ã',
    'pandas': '–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö', 
    'yt_dlp': 'YouTube –∑–∞–≥—Ä—É–∑—á–∏–∫',
    'openpyxl': 'Excel —Ñ–∞–π–ª—ã',
    'nltk': 'NLP –æ–±—Ä–∞–±–æ—Ç–∫–∞'
}

for pkg, desc in packages.items():
    try:
        __import__(pkg.replace('-', '_'))
        print(f'‚úÖ {pkg}: {desc}')
    except ImportError:
        print(f'‚ùå {pkg}: {desc} - –ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù')
"

echo.
echo üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...

if exist ".env" (
    echo ‚úÖ –§–∞–π–ª .env: –Ω–∞–π–¥–µ–Ω
) else (
    echo ‚ùå –§–∞–π–ª .env: –Ω–µ –Ω–∞–π–¥–µ–Ω
)

if exist "cookies.txt" (
    echo ‚úÖ Cookies —Ñ–∞–π–ª: –Ω–∞–π–¥–µ–Ω
) else (
    echo ‚ö†Ô∏è  Cookies —Ñ–∞–π–ª: –Ω–µ –Ω–∞–π–¥–µ–Ω (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
)

echo.
echo üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–ø–æ–∫...
for %%d in (data reports logs src) do (
    if exist "%%d" (
        echo ‚úÖ –ü–∞–ø–∫–∞ %%d: —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    ) else (
        echo ‚ùå –ü–∞–ø–∫–∞ %%d: –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
    )
)

echo.
echo üîç –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
echo –ü–∞–ø–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞: %cd%
echo –°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ: 
powershell -command "Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object @{n='FreeSpace';e={[math]::Round($_.FreeSpace/1GB,2)}} | Format-Table -HideTableHeaders"

echo –û–ó–£:
powershell -command "Get-WmiObject -Class Win32_ComputerSystem | Select-Object @{n='TotalRAM';e={[math]::Round($_.TotalPhysicalMemory/1GB,2)}} | Format-Table -HideTableHeaders"

echo.
echo üí° –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã:
echo - ‚ùå Python: –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å python.org
echo - ‚ùå –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏: –∑–∞–ø—É—Å—Ç–∏—Ç–µ setup_windows.bat
echo - ‚ùå –ü–∞–ø–∫–∏: –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ

pause
goto main_menu

:help
cls
echo =============================================================================
echo üìö –ü–û–ú–û–©–¨ –ò –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø
echo =============================================================================
echo.

echo üéØ –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï –ü–†–û–ì–†–ê–ú–ú–´:
echo YouTube Analyzer - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ –Ω–∞ YouTube.
echo –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–∏–¥–µ–æ –∏ –∫–∞–Ω–∞–ª—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤,
echo —Å–æ–∑–¥–∞–≤–∞—è –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –¥–ª—è –≤–∞—à–µ–π –∫–æ–Ω—Ç–µ–Ω—Ç-—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.
echo.

echo üìã –ß–¢–û –ê–ù–ê–õ–ò–ó–ò–†–£–ï–¢ –ü–†–û–ì–†–ê–ú–ú–ê:
echo ‚Ä¢ –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –≤–∏–¥–µ–æ –ø–æ –≤–∞—à–µ–π —Ç–µ–º–∞—Ç–∏–∫–µ
echo ‚Ä¢ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤, –ª–∞–π–∫–æ–≤, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
echo ‚Ä¢ –¢–µ–º—ã –∏ —Ñ–æ—Ä–º–∞—Ç—ã —É—Å–ø–µ—à–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
echo ‚Ä¢ –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—â–∏—Ö –∫–∞–Ω–∞–ª–æ–≤
echo ‚Ä¢ –¶–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é –∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
echo ‚Ä¢ –ü—Ä–∏–∑—ã–≤—ã –∫ –¥–µ–π—Å—Ç–≤–∏—é (CTA) –∏ –≤–æ—Ä–æ–Ω–∫–∏ –ø—Ä–æ–¥–∞–∂
echo.

echo üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–ù–ê–õ–ò–ó–ê:
echo ‚Ä¢ videos_analysis.xlsx - –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤–∏–¥–µ–æ
echo ‚Ä¢ channels_analysis.xlsx - –∞–Ω–∞–ª–∏–∑ –∫–∞–Ω–∞–ª–æ–≤ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
echo ‚Ä¢ summary_report.xlsx - —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
echo.

echo üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢:
echo 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ "–ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤" –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é
echo 2. –í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞/—É—Å–ª—É–≥–∏
echo 3. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∞–Ω–∞–ª–∏–∑–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è "–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π")
echo 4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (10-30 –º–∏–Ω—É—Ç)
echo 5. –û—Ç–∫—Ä–æ–π—Ç–µ Excel –æ—Ç—á–µ—Ç—ã –∏–∑ –ø–∞–ø–∫–∏ reports\
echo.

echo ‚öôÔ∏è  –ù–ê–°–¢–†–û–ô–ö–ò:
echo ‚Ä¢ YouTube API –∫–ª—é—á - —É–ª—É—á—à–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
echo ‚Ä¢ Cookies —Ñ–∞–π–ª - –ø–æ–º–æ–≥–∞–µ—Ç –æ–±—Ö–æ–¥–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
echo ‚Ä¢ –ü—Ä–æ–∫—Å–∏ - –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç–∏ –∏ –æ–±—Ö–æ–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
echo ‚Ä¢ –õ–∏–º–∏—Ç—ã - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
echo.

echo üîß –£–°–¢–†–ê–ù–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú:
echo ‚Ä¢ –ï—Å–ª–∏ YouTube –±–ª–æ–∫–∏—Ä—É–µ—Ç - –¥–æ–±–∞–≤—å—Ç–µ cookies –∏–ª–∏ –ø—Ä–æ–∫—Å–∏
echo ‚Ä¢ –ï—Å–ª–∏ –º–µ–¥–ª–µ–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç - —É–º–µ–Ω—å—à–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ
echo ‚Ä¢ –ï—Å–ª–∏ –æ—à–∏–±–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ - –∑–∞–ø—É—Å—Ç–∏—Ç–µ setup_windows.bat
echo ‚Ä¢ –õ–æ–≥–∏ –æ—à–∏–±–æ–∫ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ logs\youtube_analysis.log
echo.

echo üìû –ü–û–î–î–ï–†–ñ–ö–ê:
echo ‚Ä¢ –í—Å–µ –ª–æ–≥–∏ –∏ –æ—à–∏–±–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
echo ‚Ä¢ –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞"
echo ‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: README.md –∏ –£–°–¢–ê–ù–û–í–ö–ê_WINDOWS.md
echo.

pause
goto main_menu

:exit
echo.
echo üëã –°–ø–∞—Å–∏–±–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ YouTube Analyzer!
echo üí° –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ C:\youtube-analyzer\reports\
echo.
pause
exit /b 0