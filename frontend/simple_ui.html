<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>YouTube Analyzer - Simple UI</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1 { color: #333; }
        .section { margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 5px; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 4px; }
        button:hover { background: #0056b3; }
        textarea { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 4px; }
        .result { margin: 10px 0; padding: 10px; background: #e9ecef; border-radius: 4px; }
        .error { background: #f8d7da; color: #721c24; }
        .success { background: #d4edda; color: #155724; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé• YouTube Analyzer - –ü—Ä–æ—Å—Ç–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å</h1>
        
        <div class="section">
            <h2>üìã –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</h2>
            <textarea id="keywords" rows="3" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (–∫–∞–∂–¥–æ–µ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏)">python tutorial
web development</textarea>
            <br>
            <button onclick="createSimpleTask()">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</button>
            <div id="task-result"></div>
        </div>
        
        <div class="section">
            <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
            <button onclick="loadStats()">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
            <div id="stats-result"></div>
        </div>
        
        <div class="section">
            <h2>üé¨ –í–∏–¥–µ–æ</h2>
            <button onclick="loadVideos()">–ü–æ–∫–∞–∑–∞—Ç—å –≤–∏–¥–µ–æ</button>
            <div id="videos-result"></div>
        </div>
        
        <div class="section">
            <h2>üì∫ –ö–∞–Ω–∞–ª—ã</h2>
            <button onclick="loadChannels()">–ü–æ–∫–∞–∑–∞—Ç—å –∫–∞–Ω–∞–ª—ã</button>
            <div id="channels-result"></div>
        </div>
    </div>

    <script>
        // –ü—Ä–æ—Å—Ç–æ–π API –∫–ª–∏–µ–Ω—Ç –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        async function apiCall(endpoint, options = {}) {
            try {
                const response = await fetch('/api' + endpoint, {
                    headers: {'Content-Type': 'application/json'},
                    ...options
                });
                const data = await response.json();
                return {success: response.ok, data};
            } catch (error) {
                return {success: false, error: error.message};
            }
        }
        
 async function createSimpleTask() {
    const keywords = document.getElementById('keywords').value
        .split('\n')
        .map(k => k.trim())
        .filter(k => k);
        
    if (keywords.length === 0) {
        document.getElementById('task-result').innerHTML = '<div class="result error">–í–≤–µ–¥–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ</div>';
        return;
    }
    
    try {
        const response = await fetch('/api/tasks/', {  // –î–æ–±–∞–≤–ª–µ–Ω —Å–ª–µ—à –≤ –∫–æ–Ω—Ü–µ!
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                keywords: keywords,
                channels: [],
                order_by: 'relevance',
                max_videos_per_source: 20
            })
        });
        
        const data = await response.json();
        
        if (response.ok) {
            document.getElementById('task-result').innerHTML = 
                `<div class="result success">‚úÖ –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞! ID: ${data.task_id}</div>`;
        } else {
            document.getElementById('task-result').innerHTML = 
                `<div class="result error">‚ùå –û—à–∏–±–∫–∞: ${data.detail || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}</div>`;
        }
    } catch (error) {
        document.getElementById('task-result').innerHTML = 
            `<div class="result error">‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}</div>`;
    }
}
        
        async function loadStats() {
            const result = await apiCall('/data/stats');
            
            if (result.success) {
                document.getElementById('stats-result').innerHTML = `
                    <div class="result">
                        <strong>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</strong><br>
                        –í–∏–¥–µ–æ: ${result.data.total_videos}<br>
                        –ö–∞–Ω–∞–ª–æ–≤: ${result.data.total_channels}<br>
                        –ó–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: ${result.data.completed_tasks}<br>
                        –°—Ä–µ–¥–Ω—è—è –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å: ${result.data.avg_engagement}%
                    </div>
                `;
            } else {
                document.getElementById('stats-result').innerHTML = 
                    `<div class="result error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>`;
            }
        }
        
        async function loadVideos() {
            const result = await apiCall('/data/videos?limit=10');
            
            if (result.success && result.data.length > 0) {
                let html = '<div class="result"><strong>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤–∏–¥–µ–æ:</strong><br>';
                result.data.forEach(video => {
                    html += `‚Ä¢ ${video.title} (${video.views} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤)<br>`;
                });
                html += '</div>';
                document.getElementById('videos-result').innerHTML = html;
            } else {
                document.getElementById('videos-result').innerHTML = 
                    `<div class="result">–ù–µ—Ç –≤–∏–¥–µ–æ</div>`;
            }
        }
        
        async function loadChannels() {
            const result = await apiCall('/data/channels');
            
            if (result.success && result.data.length > 0) {
                let html = '<div class="result"><strong>–ö–∞–Ω–∞–ª—ã:</strong><br>';
                result.data.forEach(channel => {
                    html += `‚Ä¢ ${channel.channel_title} (${channel.subscriber_count} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤)<br>`;
                });
                html += '</div>';
                document.getElementById('channels-result').innerHTML = html;
            } else {
                document.getElementById('channels-result').innerHTML = 
                    `<div class="result">–ù–µ—Ç –∫–∞–Ω–∞–ª–æ–≤</div>`;
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            console.log('Simple UI loaded');
            loadStats();
        };
    </script>
</body>
</html>