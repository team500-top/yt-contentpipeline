@echo off
chcp 65001 >nul
echo =============================================================================
echo YouTube Competitor Analysis Tool - –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞
echo =============================================================================
echo.

REM –ü–µ—Ä–µ—Ö–æ–¥ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd /d "C:\youtube-analyzer"

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤
if not exist "main.py" (
    echo ‚ùå –§–∞–π–ª main.py –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ C:\youtube-analyzer\
    echo –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ —ç—Ç—É –ø–∞–ø–∫—É
    pause
    exit /b 1
)

if not exist "venv\Scripts\python.exe" (
    echo ‚ùå –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
    echo –ó–∞–ø—É—Å—Ç–∏—Ç–µ setup_windows.bat –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
    pause
    exit /b 1
)

REM –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
echo üîÑ –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è...
call venv\Scripts\activate

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ .env —Ñ–∞–π–ª–∞
if not exist ".env" (
    echo ‚ö†Ô∏è  –§–∞–π–ª .env –Ω–µ –Ω–∞–π–¥–µ–Ω. –°–æ–∑–¥–∞—é –±–∞–∑–æ–≤—ã–π...
    echo YOUTUBE_API_KEY=>.env
    echo YOUTUBE_COOKIES_FILE=C:\youtube-analyzer\cookies.txt>>.env
    echo MAX_TOTAL_VIDEOS=50>>.env
    echo MAX_CHANNELS_TO_ANALYZE=20>>.env
    echo MAX_WORKERS=4>>.env
    echo LOG_LEVEL=INFO>>.env
    echo LOG_FILE=C:\youtube-analyzer\logs\youtube_analysis.log>>.env
)

echo.
echo üéØ –ó–ê–ü–£–°–ö –ê–ù–ê–õ–ò–ó–ê YOUTUBE –ö–û–ù–ö–£–†–ï–ù–¢–û–í
echo.

REM –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ñ—Ñ–µ—Ä–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
set /p offer="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ñ—Ñ–µ—Ä (–æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞/—É—Å–ª—É–≥–∏): "

if "%offer%"=="" (
    echo ‚ùå –û—Ñ—Ñ–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º!
    pause
    exit /b 1
)

echo.
echo üìä –û–ø—Ü–∏–∏ –∞–Ω–∞–ª–∏–∑–∞:
echo 1. –ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ (50 –≤–∏–¥–µ–æ, 20 –∫–∞–Ω–∞–ª–æ–≤)
echo 2. –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (100 –≤–∏–¥–µ–æ, 30 –∫–∞–Ω–∞–ª–æ–≤)
echo 3. –ë—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑ (—Ç–æ–ª—å–∫–æ –∫–∞–Ω–∞–ª—ã, –±–µ–∑ —Å—É–±—Ç–∏—Ç—Ä–æ–≤)
echo 4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
echo.

set /p choice="–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é (1-4): "

if "%choice%"=="1" (
    set params=--max-videos 50 --max-channels 20
    echo ‚úÖ –í—ã–±—Ä–∞–Ω –±–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑
) else if "%choice%"=="2" (
    set params=--max-videos 100 --max-channels 30 --parallel 6
    echo ‚úÖ –í—ã–±—Ä–∞–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
) else if "%choice%"=="3" (
    set params=--channels-only --no-transcripts --max-channels 25
    echo ‚úÖ –í—ã–±—Ä–∞–Ω –±—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑
) else if "%choice%"=="4" (
    echo.
    set /p max_videos="–ú–∞–∫—Å–∏–º—É–º –≤–∏–¥–µ–æ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50): "
    set /p max_channels="–ú–∞–∫—Å–∏–º—É–º –∫–∞–Ω–∞–ª–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20): "
    set /p parallel="–ü–æ—Ç–æ–∫–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 4): "
    
    if "%max_videos%"=="" set max_videos=50
    if "%max_channels%"=="" set max_channels=20
    if "%parallel%"=="" set parallel=4
    
    set params=--max-videos %max_videos% --max-channels %max_channels% --parallel %parallel%
    echo ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
) else (
    set params=--max-videos 50 --max-channels 20
    echo ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
)

REM –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
echo.
set /p keywords="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ): "

if not "%keywords%"=="" (
    set params=%params% --keywords "%keywords%"
)

echo.
echo üöÄ –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞...
echo –û—Ñ—Ñ–µ—Ä: %offer%
echo –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: %params%
echo.

REM –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞
python main.py --offer "%offer%" %params%

set exit_code=%errorlevel%

echo.
if %exit_code% equ 0 (
    echo =============================================================================
    echo üéâ –ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù –£–°–ü–ï–®–ù–û!
    echo =============================================================================
    echo.
    echo üìÅ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤: C:\youtube-analyzer\reports\
    echo.
    echo üìä –°–æ–∑–¥–∞–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã:
    dir reports\*.xlsx /b 2>nul
    echo.
    echo üí° –û—Ç–∫—Ä–æ–π—Ç–µ Excel —Ñ–∞–π–ª—ã –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞
    echo.
    
    REM –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—å –ø–∞–ø–∫—É —Å –æ—Ç—á–µ—Ç–∞–º–∏
    set /p open_folder="–û—Ç–∫—Ä—ã—Ç—å –ø–∞–ø–∫—É —Å –æ—Ç—á–µ—Ç–∞–º–∏? (y/n): "
    if /i "%open_folder%"=="y" (
        explorer reports
    )
) else (
    echo =============================================================================
    echo ‚ùå –ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù –° –û–®–ò–ë–ö–ê–ú–ò
    echo =============================================================================
    echo.
    echo üìã –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥ —Ñ–∞–π–ª: C:\youtube-analyzer\logs\youtube_analysis.log
    echo.
    echo üîß –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
    echo - –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º
    echo - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ YouTube (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–∫—Å–∏/cookies)
    echo - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ .env —Ñ–∞–π–ª–µ
    echo - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
    echo.
    echo üí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:
    echo 1. –î–æ–±–∞–≤–∏—Ç—å cookies.txt —Ñ–∞–π–ª
    echo 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–∫—Å–∏ –≤ .env
    echo 3. –£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    echo 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞/—Ñ–∞–π—Ä–≤–æ–ª–∞
)

echo.
echo =============================================================================
echo üìã –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
echo.
echo –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫:
echo   run_analysis.bat
echo.
echo –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
echo   venv\Scripts\activate
echo   python main.py --offer "–í–∞—à –æ—Ñ—Ñ–µ—Ä" --max-videos 100
echo.
echo –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞:
echo   rmdir /s /q .cache
echo.
echo –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
echo   type logs\youtube_analysis.log
echo.
echo –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
echo   venv\Scripts\activate
echo   pip install --upgrade -r requirements.txt
echo.
echo =============================================================================

pause