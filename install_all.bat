@echo off
chcp 65001 >nul
title YouTube Analyzer - –ü–æ–ª–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
color 0B

echo.
echo ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó 
echo ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó
echo ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù
echo ‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïù 
echo ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë     
echo ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù   ‚ïö‚ïê‚ïù    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù     
echo.
echo          YOUTUBE ANALYZER - –ü–û–õ–ù–ê–Ø –£–°–¢–ê–ù–û–í–ö–ê
echo               –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã
echo.
echo =============================================================================

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
net session >nul 2>&1
if %errorlevel% neq 0 (
    echo ‚ùå –¢–†–ï–ë–£–Æ–¢–°–Ø –ü–†–ê–í–ê –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê!
    echo.
    echo üîí –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
    echo    1. –©–µ–ª–∫–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –ø–æ —Ñ–∞–π–ª—É
    echo    2. –í—ã–±–µ—Ä–∏—Ç–µ "–ó–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"
    echo.
    pause
    exit /b 1
)

echo ‚úÖ –ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–æ–ª—É—á–µ–Ω—ã
echo.

REM –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
echo üìÅ –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞...
if not exist "C:\" (
    echo ‚ùå –î–∏—Å–∫ C: –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω!
    pause
    exit /b 1
)

REM –°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–ø–∫–∏ —Å –ø—Ä–∞–≤–∞–º–∏
mkdir "C:\youtube-analyzer" 2>nul
cd /d "C:\youtube-analyzer"

REM –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª–Ω—ã—Ö –ø—Ä–∞–≤ –¥–ª—è –ø–∞–ø–∫–∏
icacls "C:\youtube-analyzer" /grant Everyone:F /T /Q >nul 2>&1

echo ‚úÖ –ü–∞–ø–∫–∞ C:\youtube-analyzer —Å–æ–∑–¥–∞–Ω–∞ —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏

REM –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∞–ø–æ–∫
for %%d in (data reports logs src templates tests .cache venv) do (
    mkdir "%%d" 2>nul
)

echo ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ —Å–æ–∑–¥–∞–Ω–∞

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Python
echo.
echo üêç –ü—Ä–æ–≤–µ—Ä–∫–∞ Python...
python --version >nul 2>&1
if %errorlevel% neq 0 (
    echo ‚ùå Python –Ω–µ –Ω–∞–π–¥–µ–Ω!
    echo.
    echo üì• –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Python...
    
    REM –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Python
    powershell -Command "& {
        $url = 'https://www.python.org/ftp/python/3.11.7/python-3.11.7-amd64.exe'
        $output = 'python-installer.exe'
        Write-Host '–°–∫–∞—á–∏–≤–∞–Ω–∏–µ Python...'
        Invoke-WebRequest -Uri $url -OutFile $output
        Write-Host '–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python...'
        Start-Process -FilePath $output -ArgumentList '/quiet InstallAllUsers=1 PrependPath=1 Include_test=0' -Wait
        Remove-Item $output
    }"
    
    REM –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ PATH
    refreshenv >nul 2>&1
    
    REM –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
    python --version >nul 2>&1
    if %errorlevel% neq 0 (
        echo ‚ùå –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –Ω–µ —É–¥–∞–ª–∞—Å—å
        echo üîß –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python –≤—Ä—É—á–Ω—É—é —Å https://python.org/downloads/
        echo ‚ö†Ô∏è  –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –æ—Ç–º–µ—Ç—å—Ç–µ "Add Python to PATH"
        pause
        exit /b 1
    )
)

echo ‚úÖ Python —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
python --version

REM –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
echo.
echo üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è...
if not exist "venv\Scripts\python.exe" (
    python -m venv venv
    if %errorlevel% neq 0 (
        echo ‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
        pause
        exit /b 1
    )
)

echo ‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ

REM –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ pip
call venv\Scripts\activate
python -m pip install --upgrade pip --quiet

echo ‚úÖ pip –æ–±–Ω–æ–≤–ª–µ–Ω

REM –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø–æ—ç—Ç–∞–ø–Ω–æ
echo.
echo üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...

echo   üìä –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏...
pip install --quiet requests beautifulsoup4 pandas numpy python-dotenv
if %errorlevel% neq 0 (
    echo ‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
    pause
    exit /b 1
)

echo   üìÅ Excel –ø–æ–¥–¥–µ—Ä–∂–∫–∞...
pip install --quiet openpyxl xlsxwriter
if %errorlevel% neq 0 (
    echo ‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Excel –±–∏–±–ª–∏–æ—Ç–µ–∫
    pause
    exit /b 1
)

echo   üì∫ YouTube –±–∏–±–ª–∏–æ—Ç–µ–∫–∏...
pip install --quiet yt-dlp youtube-transcript-api google-api-python-client
if %errorlevel% neq 0 (
    echo ‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ YouTube –±–∏–±–ª–∏–æ—Ç–µ–∫
    pause
    exit /b 1
)

echo   üß† NLP –±–∏–±–ª–∏–æ—Ç–µ–∫–∏...
pip install --quiet nltk spacy textstat
if %errorlevel% neq 0 (
    echo ‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ NLP –±–∏–±–ª–∏–æ—Ç–µ–∫
    pause
    exit /b 1
)

echo   üìà –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è...
pip install --quiet matplotlib seaborn wordcloud plotly
if %errorlevel% neq 0 (
    echo ‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
    pause
    exit /b 1
)

echo   üõ†Ô∏è  –£—Ç–∏–ª–∏—Ç—ã...
pip install --quiet tqdm rich colorama diskcache fake-useragent
if %errorlevel% neq 0 (
    echo ‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —É—Ç–∏–ª–∏—Ç
    pause
    exit /b 1
)

echo ‚úÖ –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

REM –ó–∞–≥—Ä—É–∑–∫–∞ —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π
echo.
echo üåç –ó–∞–≥—Ä—É–∑–∫–∞ —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π...

echo   üìù NLTK –¥–∞–Ω–Ω—ã–µ...
python -c "
import nltk
import ssl
try:
    _create_unverified_https_context = ssl._create_unverified_context
except AttributeError:
    pass
else:
    ssl._create_default_https_context = _create_unverified_https_context

nltk.download('punkt', quiet=True)
nltk.download('stopwords', quiet=True)
nltk.download('vader_lexicon', quiet=True)
print('‚úÖ NLTK –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã')
"

echo   üî§ spaCy –º–æ–¥–µ–ª—å...
python -m spacy download ru_core_news_sm --quiet
if %errorlevel% equ 0 (
    echo ‚úÖ spaCy –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞
) else (
    echo ‚ö†Ô∏è  spaCy –º–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ (–±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω fallback)
)

REM –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
echo.
echo ‚öôÔ∏è  –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...

REM –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞
(
echo # =============================================================================
echo # YouTube Analyzer Configuration - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–æ
echo # =============================================================================
echo.
echo # YouTube Data API v3 Key
echo # –ü–æ–ª—É—á–∏—Ç—å –Ω–∞: https://console.cloud.google.com/
echo YOUTUBE_API_KEY=
echo.
echo # Cookies —Ñ–∞–π–ª –¥–ª—è –æ–±—Ö–æ–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
echo YOUTUBE_COOKIES_FILE=C:\youtube-analyzer\cookies.txt
echo.
echo # –ü—Ä–æ–∫—Å–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ^(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ^)
echo HTTP_PROXY=
echo HTTPS_PROXY=
echo.
echo # –õ–∏–º–∏—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
echo MAX_TOTAL_VIDEOS=50
echo MAX_CHANNELS_TO_ANALYZE=20
echo MAX_VIDEOS_PER_KEYWORD=10
echo.
echo # –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
echo MAX_WORKERS=4
echo REQUEST_DELAY=2.0
echo API_REQUEST_DELAY=1.0
echo.
echo # –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
echo ENABLE_TRANSCRIPT_EXTRACTION=true
echo ENABLE_CONTENT_ANALYSIS=true
echo ENABLE_SENTIMENT_ANALYSIS=false
echo.
echo # –í—ã–≤–æ–¥
echo EXCEL_OUTPUT_ENABLED=true
echo JSON_OUTPUT_ENABLED=false
echo CHARTS_ENABLED=true
echo.
echo # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
echo LOG_LEVEL=INFO
echo LOG_FILE=C:\youtube-analyzer\logs\youtube_analysis.log
echo.
echo # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
echo ENABLE_CACHING=true
echo CACHE_DURATION_HOURS=24
) > .env

echo ‚úÖ –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è .env —Å–æ–∑–¥–∞–Ω–∞

REM –°–æ–∑–¥–∞–Ω–∏–µ .gitignore
(
echo # –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
echo .env
echo cookies.txt
echo *.key
echo.
echo # Python
echo __pycache__/
echo *.pyc
echo venv/
echo.
echo # –õ–æ–≥–∏ –∏ –∫—ç—à
echo logs/
echo .cache/
echo *.log
echo.
echo # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
echo *.tmp
echo .DS_Store
echo Thumbs.db
) > .gitignore

echo ‚úÖ .gitignore —Å–æ–∑–¥–∞–Ω

REM –°–æ–∑–¥–∞–Ω–∏–µ __init__.py —Ñ–∞–π–ª–æ–≤
echo. > src\__init__.py
echo. > templates\__init__.py  
echo. > tests\__init__.py

REM –°–æ–∑–¥–∞–Ω–∏–µ requirements.txt
(
echo # YouTube Analyzer Requirements
echo requests==2.31.0
echo beautifulsoup4==4.12.2
echo pandas==2.1.4
echo numpy==1.24.3
echo python-dotenv==1.0.0
echo openpyxl==3.1.2
echo yt-dlp==2023.12.30
echo youtube-transcript-api==0.6.1
echo google-api-python-client==2.110.0
echo nltk==3.8.1
echo spacy==3.7.2
echo textstat==0.7.3
echo matplotlib==3.8.2
echo seaborn==0.13.0
echo wordcloud==1.9.2
echo tqdm==4.66.1
echo rich==13.7.0
echo colorama==0.4.6
echo diskcache==5.6.3
echo fake-useragent==1.4.0
) > requirements.txt

echo ‚úÖ requirements.txt —Å–æ–∑–¥–∞–Ω

REM –°–æ–∑–¥–∞–Ω–∏–µ README —Ñ–∞–π–ª–∞
(
echo # YouTube Analyzer - –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!
echo.
echo ## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫
echo.
echo 1. –î–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω–∏—Ç–µ –ø–æ —Ñ–∞–π–ª—É `–ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢.bat`
echo 2. –í—ã–±–µ—Ä–∏—Ç–µ "–ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤"
echo 3. –í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞/—É—Å–ª—É–≥–∏
echo 4. –î–æ–∂–¥–∏—Ç–µ—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –ø–∞–ø–∫–µ `reports\`
echo.
echo ## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞
echo.
echo - –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `.env` –¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
echo - –î–æ–±–∞–≤—å—Ç–µ YouTube API –∫–ª—é—á –¥–ª—è –ª—É—á—à–µ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
echo - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ cookies.txt –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞—Ö
echo.
echo ## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞
echo.
echo - `reports\` - Excel –æ—Ç—á–µ—Ç—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
echo - `logs\` - –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
echo - `data\` - –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
echo - `.env` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
echo.
echo –î–∞—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏: %date% %time%
) > README.md

echo ‚úÖ README.md —Å–æ–∑–¥–∞–Ω

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
echo.
echo ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏...
python -c "
import sys
print(f'Python: {sys.version}')

packages = ['requests', 'pandas', 'yt_dlp', 'openpyxl', 'nltk']
missing = []

for pkg in packages:
    try:
        __import__(pkg.replace('-', '_'))
        print(f'‚úÖ {pkg}')
    except ImportError:
        missing.append(pkg)
        print(f'‚ùå {pkg}')

if not missing:
    print('\\nüéâ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!')
else:
    print(f'\\n‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç: {missing}')
"

REM –°–æ–∑–¥–∞–Ω–∏–µ —è—Ä–ª—ã–∫–∞ –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ
echo.
echo üñ•Ô∏è  –°–æ–∑–¥–∞–Ω–∏–µ —è—Ä–ª—ã–∫–∞ –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ...
powershell -Command "
$WshShell = New-Object -comObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut('%USERPROFILE%\Desktop\YouTube Analyzer.lnk')
$Shortcut.TargetPath = 'C:\youtube-analyzer\–ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢.bat'
$Shortcut.WorkingDirectory = 'C:\youtube-analyzer'
$Shortcut.Description = 'YouTube Competitor Analysis Tool'
$Shortcut.Save()
"

if %errorlevel% equ 0 (
    echo ‚úÖ –Ø—Ä–ª—ã–∫ —Å–æ–∑–¥–∞–Ω –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ
) else (
    echo ‚ö†Ô∏è  –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —è—Ä–ª—ã–∫
)

REM –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –º–µ–Ω—é –ü—É—Å–∫
echo.
echo üìã –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –º–µ–Ω—é –ü—É—Å–∫...
mkdir "%APPDATA%\Microsoft\Windows\Start Menu\Programs\YouTube Analyzer" 2>nul
powershell -Command "
$WshShell = New-Object -comObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut('%APPDATA%\Microsoft\Windows\Start Menu\Programs\YouTube Analyzer\YouTube Analyzer.lnk')
$Shortcut.TargetPath = 'C:\youtube-analyzer\–ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢.bat'
$Shortcut.WorkingDirectory = 'C:\youtube-analyzer'
$Shortcut.Save()
"

echo ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –º–µ–Ω—é –ü—É—Å–∫

echo.
echo =============================================================================
echo üéâ –£–°–¢–ê–ù–û–í–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê –£–°–ü–ï–®–ù–û!
echo =============================================================================
echo.
echo üìä YouTube Analyzer –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!
echo.
echo üìÅ –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ: C:\youtube-analyzer\
echo üöÄ –ó–∞–ø—É—Å–∫: –Ø—Ä–ª—ã–∫ –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ –∏–ª–∏ –º–µ–Ω—é –ü—É—Å–∫
echo ‚öôÔ∏è  –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: .env —Ñ–∞–π–ª
echo üìã –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: README.md
echo.
echo üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:
echo.
echo 1. üîë –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø: –ü–æ–ª—É—á–∏—Ç—å YouTube API –∫–ª—é—á
echo    ‚Ä¢ –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://console.cloud.google.com/
echo    ‚Ä¢ –í–∫–ª—é—á–∏—Ç–µ YouTube Data API v3
echo    ‚Ä¢ –°–æ–∑–¥–∞–π—Ç–µ API Key
echo    ‚Ä¢ –î–æ–±–∞–≤—å—Ç–µ –≤ .env —Ñ–∞–π–ª: YOUTUBE_API_KEY=–≤–∞—à_–∫–ª—é—á
echo.
echo 2. üç™ –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –¥–æ—Å—Ç—É–ø–æ–º: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å cookies
echo    ‚Ä¢ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ "Get cookies.txt"
echo    ‚Ä¢ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ cookies —Å youtube.com
echo    ‚Ä¢ –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ C:\youtube-analyzer\cookies.txt
echo.
echo 3. üöÄ –ó–ê–ü–£–°–ö –ê–ù–ê–õ–ò–ó–ê:
echo    ‚Ä¢ –î–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω–∏—Ç–µ —è—Ä–ª—ã–∫ "YouTube Analyzer" –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ
echo    ‚Ä¢ –ò–õ–ò –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢.bat
echo    ‚Ä¢ –ò–õ–ò –Ω–∞–π–¥–∏—Ç–µ –≤ –º–µ–Ω—é –ü—É—Å–∫
echo.
echo üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ C:\youtube-analyzer\reports\
echo.
echo =============================================================================
echo.
echo üí° –ü–û–õ–ï–ó–ù–´–ï –ö–û–ú–ê–ù–î–´:
echo.
echo –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞:     –ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢.bat
echo –ù–∞—Å—Ç—Ä–æ–π–∫–∏:          notepad .env
echo –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç—á–µ—Ç–æ–≤:   explorer reports
echo –õ–æ–≥–∏:               type logs\youtube_analysis.log
echo –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:         pip install --upgrade -r requirements.txt
echo.
echo =============================================================================

REM –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å—Ä–∞–∑—É –∑–∞–ø—É—Å—Ç–∏—Ç—å
echo.
set /p launch="üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å YouTube Analyzer —Å–µ–π—á–∞—Å? (y/n): "
if /i "%launch%"=="y" (
    start "" "–ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢.bat"
)

echo.
echo üéâ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ YouTube Analyzer!
echo.
pause